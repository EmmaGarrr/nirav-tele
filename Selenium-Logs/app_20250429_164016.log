2025-04-29 16:40:16,253 - INFO - [MainThread] [<module>] - ============================================================
2025-04-29 16:40:16,253 - INFO - [MainThread] [<module>] - Logging configured. Level: INFO. Log file: Selenium-Logs\app_20250429_164016.log
2025-04-29 16:40:16,254 - INFO - [MainThread] [<module>] - Primary Chat ID: -4603853425
2025-04-29 16:40:16,254 - INFO - [MainThread] [<module>] - All Target Chat IDs: ['-4603853425']
2025-04-29 16:40:16,256 - INFO - [MainThread] [<module>] - Chunk Size: 41943040 bytes
2025-04-29 16:40:16,256 - INFO - [MainThread] [<module>] - API Timeouts (Connect/Read): 10s / 60s
2025-04-29 16:40:16,256 - INFO - [MainThread] [<module>] - API Retries: 3 attempts, 2s delay
2025-04-29 16:40:16,257 - INFO - [MainThread] [<module>] - Max Upload Workers: 3
2025-04-29 16:40:16,257 - INFO - [MainThread] [<module>] - Max Download Workers: 12
2025-04-29 16:40:16,257 - INFO - [MainThread] [<module>] - ============================================================
2025-04-29 16:40:16,258 - INFO - [MainThread] [<module>] - Configuration loaded successfully.
2025-04-29 16:40:16,258 - INFO - [MainThread] [<module>] - Utility functions defined.
2025-04-29 16:40:16,260 - INFO - [MainThread] [<module>] - Custom Jinja filter 'format_bytes' registered.
2025-04-29 16:40:16,260 - INFO - [MainThread] [<module>] - Flask-CORS initialized. Allowing origins: http://localhost:4200
2025-04-29 16:40:16,261 - INFO - [MainThread] [<module>] - Flask application initialized.
2025-04-29 16:40:16,261 - INFO - [MainThread] [<module>] - Global state variables initialized (upload_progress_data, download_prep_data).
2025-04-29 16:40:16,264 - INFO - [MainThread] [<module>] - Custom Jinja filter 'format_bytes' registered.
2025-04-29 16:40:16,264 - INFO - [MainThread] [<module>] - Flask-CORS initialized. Allowing origins: http://localhost:4200
2025-04-29 16:40:16,264 - INFO - [MainThread] [<module>] - Flask application initialized.
2025-04-29 16:40:16,265 - INFO - [MainThread] [<module>] - Global state variables initialized (upload_progress_data, download_prep_data).
2025-04-29 16:40:16,716 - INFO - [MainThread] [<module>] - Initialized requests.Session for Telegram API calls.
2025-04-29 16:40:16,717 - INFO - [MainThread] [<module>] - Telegram API functions defined with Session and Retries.
2025-04-29 16:40:16,718 - INFO - [MainThread] [<module>] - Flask routes defined using configurable workers and linter fixes.
2025-04-29 16:40:16,718 - INFO - [MainThread] [<module>] - Starting Flask development server...
2025-04-29 16:40:16,753 - WARNING - [MainThread] [_log] -  * Debugger is active!
2025-04-29 16:40:16,753 - INFO - [MainThread] [_log] -  * Debugger PIN: 107-410-311
2025-04-29 16:40:19,167 - INFO - [Thread-3 (process_request_thread)] [index] - Serving index page.
2025-04-29 16:40:19,187 - INFO - [Thread-3 (process_request_thread)] [_log] - 127.0.0.1 - - [29/Apr/2025 16:40:19] "GET / HTTP/1.1" 200 -
2025-04-29 16:41:03,853 - INFO - [Thread-2 (process_request_thread)] [initiate_upload] - Request initiate upload.
2025-04-29 16:41:04,912 - INFO - [Thread-2 (process_request_thread)] [initiate_upload] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Temp storage: uploads_temp\8334e2f9-2f84-471a-897d-121a7e78cc0b_WindsurfUserSetup-x64-1.7.1.exe
2025-04-29 16:41:05,087 - INFO - [Thread-2 (process_request_thread)] [initiate_upload] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Temp saved: 'WindsurfUserSetup-x64-1.7.1.exe'.
2025-04-29 16:41:05,097 - INFO - [Thread-2 (process_request_thread)] [_log] - 127.0.0.1 - - [29/Apr/2025 16:41:05] "POST /initiate-upload HTTP/1.1" 200 -
2025-04-29 16:41:05,111 - INFO - [Thread-4 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: 8334e2f9-2f84-471a-897d-121a7e78cc0b
2025-04-29 16:41:05,112 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Starting processing generator...
2025-04-29 16:41:05,113 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Processing: User='ELENA', File='WindsurfUserSetup-x64-1.7.1.exe'
2025-04-29 16:41:05,113 - INFO - [Thread-4 (process_request_thread)] [_log] - 127.0.0.1 - - [29/Apr/2025 16:41:05] "GET /stream-progress/8334e2f9-2f84-471a-897d-121a7e78cc0b HTTP/1.1" 200 -
2025-04-29 16:41:05,114 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Access ID: 01426eff60
2025-04-29 16:41:05,114 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Large file workflow.
2025-04-29 16:41:09,788 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Compressed to 136492932 bytes in 4.67s.
2025-04-29 16:41:09,987 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Read chunk 1 (41943040 bytes). Name: 'WindsurfUserSetup-x64-1.7.1.zip.part_001'
2025-04-29 16:41:09,987 - INFO - [Thread-4 (process_request_thread)] [_send_chunk_task] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] T> Sending chunk 1 ('WindsurfUserSetup-x64-1.7.1.zip.part_001') to -4603853425
2025-04-29 16:41:09,987 - INFO - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'WindsurfUserSetup-x64-1.7.1.zip.part_001'] Attempting send.
2025-04-29 16:41:20,378 - WARNING - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'WindsurfUserSetup-x64-1.7.1.zip.part_001'] Connection error attempt 1: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7812479394:AAFrzOcHGKfc-1iOUbVEkptJkooaJrXHAxs/sendDocument (Caused by SSLError(SSLWantWriteError(3, 'The operation did not complete (write) (_ssl.c:2427)')))
2025-04-29 16:41:20,378 - INFO - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'WindsurfUserSetup-x64-1.7.1.zip.part_001'] Retrying in 2s...
2025-04-29 16:41:22,543 - INFO - [Thread-5 (process_request_thread)] [initiate_upload] - Request initiate upload.
2025-04-29 16:41:22,543 - INFO - [Thread-5 (process_request_thread)] [initiate_upload] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Temp storage: uploads_temp\5d2aa095-1cbf-42bb-b149-c1f231bd5a32_file-browser.ts
2025-04-29 16:41:22,543 - INFO - [Thread-5 (process_request_thread)] [initiate_upload] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Temp saved: 'file-browser.ts'.
2025-04-29 16:41:22,543 - INFO - [Thread-5 (process_request_thread)] [_log] - 192.168.1.25 - - [29/Apr/2025 16:41:22] "POST /initiate-upload HTTP/1.1" 200 -
2025-04-29 16:41:22,563 - INFO - [Thread-6 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: 5d2aa095-1cbf-42bb-b149-c1f231bd5a32
2025-04-29 16:41:22,563 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Starting processing generator...
2025-04-29 16:41:22,569 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Processing: User='DreamyVoyage', File='file-browser.ts'
2025-04-29 16:41:22,570 - INFO - [Thread-6 (process_request_thread)] [_log] - 192.168.1.25 - - [29/Apr/2025 16:41:22] "GET /stream-progress/5d2aa095-1cbf-42bb-b149-c1f231bd5a32 HTTP/1.1" 200 -
2025-04-29 16:41:22,571 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Access ID: 2b60a0880c
2025-04-29 16:41:22,572 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Single file workflow.
2025-04-29 16:41:22,604 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Compressed size: 4716
2025-04-29 16:41:22,604 - INFO - [Thread-6 (process_request_thread)] [_send_single_file_task] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] T> Sending 'file-browser.zip' (4716b) to -4603853425
2025-04-29 16:41:22,604 - INFO - [Thread-6 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'file-browser.zip'] Attempting send.
2025-04-29 16:41:23,555 - INFO - [Thread-6 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'file-browser.zip'] API success (Attempt 1).
2025-04-29 16:41:23,556 - INFO - [Thread-6 (process_request_thread)] [_send_single_file_task] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] T> Sent 'file-browser.zip' to -4603853425. Success: True
2025-04-29 16:41:23,557 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Single sends done in 0.95s.
2025-04-29 16:41:23,557 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Success: 1/1
2025-04-29 16:41:23,572 - INFO - [Thread-6 (process_request_thread)] [load_metadata] - Successfully loaded metadata from 'metadata.json'.
2025-04-29 16:41:23,582 - INFO - [Thread-6 (process_request_thread)] [save_metadata] - Successfully saved metadata to 'metadata.json'.
2025-04-29 16:41:23,583 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Upload generator cleanup.
2025-04-29 16:41:23,584 - INFO - [Thread-6 (process_request_thread)] [_safe_remove_file] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Cleaned up original temp: uploads_temp\5d2aa095-1cbf-42bb-b149-c1f231bd5a32_file-browser.ts
2025-04-29 16:41:23,584 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [5d2aa095-1cbf-42bb-b149-c1f231bd5a32] Upload generator finished. Status: completed
2025-04-29 16:41:26,593 - INFO - [Thread-7 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: 5d2aa095-1cbf-42bb-b149-c1f231bd5a32
2025-04-29 16:41:26,593 - WARNING - [Thread-7 (process_request_thread)] [stream_progress] - Upload ID '5d2aa095-1cbf-42bb-b149-c1f231bd5a32' unknown or finalized (Status:completed).
2025-04-29 16:41:26,603 - INFO - [Thread-7 (process_request_thread)] [_log] - 192.168.1.25 - - [29/Apr/2025 16:41:26] "GET /stream-progress/5d2aa095-1cbf-42bb-b149-c1f231bd5a32 HTTP/1.1" 200 -
2025-04-29 16:41:29,638 - INFO - [Thread-8 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: 5d2aa095-1cbf-42bb-b149-c1f231bd5a32
2025-04-29 16:41:29,639 - WARNING - [Thread-8 (process_request_thread)] [stream_progress] - Upload ID '5d2aa095-1cbf-42bb-b149-c1f231bd5a32' unknown or finalized (Status:completed).
2025-04-29 16:41:29,639 - INFO - [Thread-8 (process_request_thread)] [_log] - 192.168.1.25 - - [29/Apr/2025 16:41:29] "GET /stream-progress/5d2aa095-1cbf-42bb-b149-c1f231bd5a32 HTTP/1.1" 200 -
2025-04-29 16:41:32,675 - INFO - [Thread-9 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: 5d2aa095-1cbf-42bb-b149-c1f231bd5a32
2025-04-29 16:41:32,676 - WARNING - [Thread-9 (process_request_thread)] [stream_progress] - Upload ID '5d2aa095-1cbf-42bb-b149-c1f231bd5a32' unknown or finalized (Status:completed).
2025-04-29 16:41:32,677 - INFO - [Thread-9 (process_request_thread)] [_log] - 192.168.1.25 - - [29/Apr/2025 16:41:32] "GET /stream-progress/5d2aa095-1cbf-42bb-b149-c1f231bd5a32 HTTP/1.1" 200 -
2025-04-29 16:41:32,694 - WARNING - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'WindsurfUserSetup-x64-1.7.1.zip.part_001'] Connection error attempt 2: HTTPSConnectionPool(host='api.telegram.org', port=443): Max retries exceeded with url: /bot7812479394:AAFrzOcHGKfc-1iOUbVEkptJkooaJrXHAxs/sendDocument (Caused by SSLError(SSLWantWriteError(3, 'The operation did not complete (write) (_ssl.c:2427)')))
2025-04-29 16:41:32,696 - INFO - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'WindsurfUserSetup-x64-1.7.1.zip.part_001'] Retrying in 2s...
2025-04-29 16:41:45,064 - WARNING - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'WindsurfUserSetup-x64-1.7.1.zip.part_001'] Connection error attempt 3: ('Connection aborted.', TimeoutError('The write operation timed out'))
2025-04-29 16:41:45,064 - INFO - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'WindsurfUserSetup-x64-1.7.1.zip.part_001'] Retrying in 2s...
2025-04-29 16:41:57,455 - WARNING - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'WindsurfUserSetup-x64-1.7.1.zip.part_001'] Connection error attempt 4: ('Connection aborted.', TimeoutError('The write operation timed out'))
2025-04-29 16:41:57,455 - ERROR - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File 'WindsurfUserSetup-x64-1.7.1.zip.part_001'] Send failed after 4 attempts.
Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\urllib3\connection.py", line 459, in request
    self.send(chunk)
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1019, in send
    self.sock.sendall(data)
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1273, in sendall
    v = self.send(byte_view[count:])
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1242, in send
    return self._sslobj.write(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
TimeoutError: The write operation timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\urllib3\util\retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\urllib3\util\util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\urllib3\connection.py", line 459, in request
    self.send(chunk)
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1019, in send
    self.sock.sendall(data)
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1273, in sendall
    v = self.send(byte_view[count:])
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1242, in send
    return self._sslobj.write(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.ProtocolError: ('Connection aborted.', TimeoutError('The write operation timed out'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\telegram_api.py", line 51, in send_file_to_telegram
    response = session.post(
               ^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\requests\sessions.py", line 637, in post
    return self.request("POST", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\requests\adapters.py", line 682, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', TimeoutError('The write operation timed out'))
2025-04-29 16:41:57,535 - INFO - [Thread-4 (process_request_thread)] [_send_chunk_task] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] T> Sent chunk 1 to -4603853425. Success: False
2025-04-29 16:41:57,547 - INFO - [Thread-4 (process_request_thread)] [_safe_remove_file] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Cleaned up large compressed temp: E:\Telegram_tool\Telegram_Bot_Tool\uploads_temp\8334e2f9-2f84-471a-897d-121a7e78cc0b_comp_1f8s5cr8.zip
2025-04-29 16:41:57,547 - ERROR - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Upload failed: Primary fail chunk 1: Failed after multiple attempts: ('Connection aborted.', TimeoutError('The write operation timed out'))
Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\routes.py", line 308, in process_upload_and_generate_updates
    if cid == str(PRIMARY_TELEGRAM_CHAT_ID) and not res[0]: raise IOError(f"Primary fail chunk {chunk_num}: {res[1]}")
                                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
OSError: Primary fail chunk 1: Failed after multiple attempts: ('Connection aborted.', TimeoutError('The write operation timed out'))
2025-04-29 16:41:57,547 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Upload generator cleanup.
2025-04-29 16:41:57,570 - INFO - [Thread-4 (process_request_thread)] [_safe_remove_file] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Cleaned up original temp: uploads_temp\8334e2f9-2f84-471a-897d-121a7e78cc0b_WindsurfUserSetup-x64-1.7.1.exe
2025-04-29 16:41:57,571 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [8334e2f9-2f84-471a-897d-121a7e78cc0b] Upload generator finished. Status: error
2025-04-29 16:42:09,929 - INFO - [MainThread] [_log] -  * Detected change in 'E:\\Telegram_tool\\Telegram_Bot_Tool\\config.py', reloading
