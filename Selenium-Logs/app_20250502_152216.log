2025-05-02 15:22:16,402 - INFO - [MainThread] [<module>] - ============================================================
2025-05-02 15:22:16,402 - INFO - [MainThread] [<module>] - Logging configured. Level: INFO. Log file: Selenium-Logs\app_20250502_152216.log
2025-05-02 15:22:16,412 - INFO - [MainThread] [<module>] - Primary Chat ID: -4603853425
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - All Target Chat IDs: ['-4603853425', '-1002614397019', '-4641852757']
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - Chunk Size: 20.0 MB (20971520 bytes)
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - API Timeouts (Connect/Read): 10s / 60s
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - API Retries: 3 attempts, 2s delay
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - Max Upload Workers: 5
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - Max Download Workers: 12
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - ============================================================
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - Configuration loaded successfully.
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - Custom Jinja filter 'format_bytes' registered.
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - Flask-CORS initialized. Allowing origins: *
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - Flask application initialized.
2025-05-02 15:22:16,413 - INFO - [MainThread] [<module>] - Global state variables initialized (upload_progress_data, download_prep_data).
2025-05-02 15:22:16,419 - INFO - [MainThread] [<module>] - Custom Jinja filter 'format_bytes' registered.
2025-05-02 15:22:16,420 - INFO - [MainThread] [<module>] - Flask-CORS initialized. Allowing origins: *
2025-05-02 15:22:16,420 - INFO - [MainThread] [<module>] - Flask application initialized.
2025-05-02 15:22:16,420 - INFO - [MainThread] [<module>] - Global state variables initialized (upload_progress_data, download_prep_data).
2025-05-02 15:22:16,572 - INFO - [MainThread] [<module>] - Database module initialized.
2025-05-02 15:22:17,016 - INFO - [MainThread] [<module>] - Initialized requests.Session for Telegram API calls.
2025-05-02 15:22:17,018 - INFO - [MainThread] [<module>] - Telegram API functions defined with Session and Retries.
2025-05-02 15:22:17,023 - INFO - [MainThread] [<module>] - Flask routes defined using configurable workers and linter fixes.
2025-05-02 15:22:17,024 - INFO - [MainThread] [<module>] - Starting Flask development server...
2025-05-02 15:22:17,046 - WARNING - [MainThread] [_log] -  * Debugger is active!
2025-05-02 15:22:17,052 - INFO - [MainThread] [_log] -  * Debugger PIN: 107-410-311
2025-05-02 15:22:19,919 - INFO - [Thread-3 (process_request_thread)] [index] - Serving index page.
2025-05-02 15:22:19,939 - INFO - [Thread-3 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:22:19] "GET / HTTP/1.1" 200 -
2025-05-02 15:22:20,040 - INFO - [Thread-2 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:22:20] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-05-02 15:22:22,420 - INFO - [Thread-4 (process_request_thread)] [show_register_page] - Serving registration page.
2025-05-02 15:22:22,423 - INFO - [Thread-4 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:22:22] "GET /register HTTP/1.1" 200 -
2025-05-02 15:23:00,622 - INFO - [Thread-6 (process_request_thread)] [register_user] - Received registration request.
2025-05-02 15:23:00,622 - INFO - [Thread-6 (process_request_thread)] [_connect_to_db] - Attempting to connect to MongoDB Atlas host: telegrambot.6armfs2.mongodb.net...
2025-05-02 15:23:02,027 - INFO - [Thread-6 (process_request_thread)] [_connect_to_db] - âœ… Successfully connected and pinged MongoDB Atlas!
2025-05-02 15:23:02,027 - INFO - [Thread-6 (process_request_thread)] [get_db] - Accessed database: Telegrambot
2025-05-02 15:23:02,032 - INFO - [Thread-6 (process_request_thread)] [get_userinfo_collection] - Accessed collection: userinfo
2025-05-02 15:23:02,059 - INFO - [Thread-6 (process_request_thread)] [find_user_by_email] - No user record found for email: sam12@gmail.com
2025-05-02 15:23:02,942 - INFO - [Thread-6 (process_request_thread)] [save_user] - Successfully inserted new user with ID: 681495feeb66a31cebecbeb9
2025-05-02 15:23:02,951 - INFO - [Thread-6 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:23:02] "[35m[1mPOST /register HTTP/1.1[0m" 201 -
2025-05-02 15:23:20,061 - INFO - [Thread-8 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:23:20] "GET /login HTTP/1.1" 200 -
2025-05-02 15:23:27,129 - INFO - [Thread-9 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:23:27] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-05-02 15:23:27,134 - INFO - [Thread-10 (process_request_thread)] [index] - Serving index page.
2025-05-02 15:23:27,136 - INFO - [Thread-10 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:23:27] "GET / HTTP/1.1" 200 -
2025-05-02 15:23:32,459 - INFO - [Thread-11 (process_request_thread)] [initiate_upload] - Request initiate upload.
2025-05-02 15:23:32,459 - INFO - [Thread-11 (process_request_thread)] [initiate_upload] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Temp storage: uploads_temp\af467381-4fe5-44d6-9c2a-81b2301e7f6b_image (13).png
2025-05-02 15:23:32,462 - INFO - [Thread-11 (process_request_thread)] [initiate_upload] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Temp saved: 'image (13).png'.
2025-05-02 15:23:32,462 - INFO - [Thread-11 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:23:32] "POST /initiate-upload HTTP/1.1" 200 -
2025-05-02 15:23:32,469 - INFO - [Thread-12 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: af467381-4fe5-44d6-9c2a-81b2301e7f6b
2025-05-02 15:23:32,470 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Starting processing generator...
2025-05-02 15:23:32,470 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Processing: User='admin', File='image (13).png'
2025-05-02 15:23:32,471 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Initialized Upload Executor (max=5)
2025-05-02 15:23:32,471 - INFO - [Thread-12 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:23:32] "GET /stream-progress/af467381-4fe5-44d6-9c2a-81b2301e7f6b HTTP/1.1" 200 -
2025-05-02 15:23:32,473 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Access ID: 6f1d8e4f28
2025-05-02 15:23:32,477 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Single file workflow.
2025-05-02 15:23:32,486 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Compressed size: 14502
2025-05-02 15:23:32,490 - INFO - [Upload_af46_0] [_send_single_file_task] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] T> Sending 'image (13).zip' (14502b) to -4603853425
2025-05-02 15:23:32,494 - INFO - [Upload_af46_0] [send_file_to_telegram] - [ChatID -4603853425, File 'image (13).zip'] Attempting send.
2025-05-02 15:23:32,494 - INFO - [Upload_af46_1] [_send_single_file_task] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] T> Sending 'image (13).zip' (14502b) to -1002614397019
2025-05-02 15:23:32,496 - INFO - [Upload_af46_2] [_send_single_file_task] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] T> Sending 'image (13).zip' (14502b) to -4641852757
2025-05-02 15:23:32,497 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Submitted 3 single-file tasks.
2025-05-02 15:23:32,497 - INFO - [Upload_af46_1] [send_file_to_telegram] - [ChatID -1002614397019, File 'image (13).zip'] Attempting send.
2025-05-02 15:23:32,497 - INFO - [Upload_af46_2] [send_file_to_telegram] - [ChatID -4641852757, File 'image (13).zip'] Attempting send.
2025-05-02 15:23:32,498 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Wait primary (-4603853425)...
2025-05-02 15:23:33,805 - INFO - [Upload_af46_2] [send_file_to_telegram] - [ChatID -4641852757, File 'image (13).zip'] API success (Attempt 1).
2025-05-02 15:23:33,806 - INFO - [Upload_af46_2] [_send_single_file_task] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] T> Sent 'image (13).zip' to -4641852757. Success: True
2025-05-02 15:23:33,814 - INFO - [Upload_af46_0] [send_file_to_telegram] - [ChatID -4603853425, File 'image (13).zip'] API success (Attempt 1).
2025-05-02 15:23:33,814 - INFO - [Upload_af46_0] [_send_single_file_task] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] T> Sent 'image (13).zip' to -4603853425. Success: True
2025-05-02 15:23:33,814 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Primary done. OK:True
2025-05-02 15:23:33,815 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Wait backups...
2025-05-02 15:23:33,888 - INFO - [Upload_af46_1] [send_file_to_telegram] - [ChatID -1002614397019, File 'image (13).zip'] API success (Attempt 1).
2025-05-02 15:23:33,888 - INFO - [Upload_af46_1] [_send_single_file_task] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] T> Sent 'image (13).zip' to -1002614397019. Success: True
2025-05-02 15:23:33,889 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Single sends done in 1.40s.
2025-05-02 15:23:33,889 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Success: 3/3
2025-05-02 15:23:33,889 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Attempting to save metadata to DB...
2025-05-02 15:23:33,890 - ERROR - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Upload failed: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\routes.py", line 390, in process_upload_and_generate_updates
    save_success, save_msg = save_file_metadata(record) # Call the DB function
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 142, in save_file_metadata
    collection, error = get_metadata_collection()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 116, in get_metadata_collection
    db_instance, error = get_db()
                         ^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 91, in get_db
    if _db:
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\database.py", line 342, in __bool__
    raise NotImplementedError(
NotImplementedError: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-05-02 15:23:33,896 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Upload generator cleanup.
2025-05-02 15:23:33,897 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Upload executor shutdown.
2025-05-02 15:23:33,898 - INFO - [Thread-12 (process_request_thread)] [_safe_remove_file] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Cleaned up original temp: uploads_temp\af467381-4fe5-44d6-9c2a-81b2301e7f6b_image (13).png
2025-05-02 15:23:33,902 - INFO - [Thread-12 (process_request_thread)] [process_upload_and_generate_updates] - [af467381-4fe5-44d6-9c2a-81b2301e7f6b] Upload generator finished. Status: error
2025-05-02 15:23:49,042 - INFO - [Thread-13 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:23:49] "GET /login HTTP/1.1" 200 -
2025-05-02 15:23:56,746 - INFO - [Thread-14 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:23:56] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-05-02 15:23:56,751 - INFO - [Thread-16 (process_request_thread)] [index] - Serving index page.
2025-05-02 15:23:56,754 - INFO - [Thread-16 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:23:56] "GET / HTTP/1.1" 200 -
2025-05-02 15:24:00,690 - INFO - [Thread-15 (process_request_thread)] [initiate_upload] - Request initiate upload.
2025-05-02 15:24:00,693 - INFO - [Thread-15 (process_request_thread)] [initiate_upload] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Temp storage: uploads_temp\fedadb2f-1972-4708-9a8a-0612e37d6493_image (12).png
2025-05-02 15:24:00,695 - INFO - [Thread-15 (process_request_thread)] [initiate_upload] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Temp saved: 'image (12).png'.
2025-05-02 15:24:00,696 - INFO - [Thread-15 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:00] "POST /initiate-upload HTTP/1.1" 200 -
2025-05-02 15:24:00,700 - INFO - [Thread-17 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: fedadb2f-1972-4708-9a8a-0612e37d6493
2025-05-02 15:24:00,701 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Starting processing generator...
2025-05-02 15:24:00,702 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Processing: User='admin', File='image (12).png'
2025-05-02 15:24:00,702 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Initialized Upload Executor (max=5)
2025-05-02 15:24:00,702 - INFO - [Thread-17 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:00] "GET /stream-progress/fedadb2f-1972-4708-9a8a-0612e37d6493 HTTP/1.1" 200 -
2025-05-02 15:24:00,703 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Access ID: 70f872c7a7
2025-05-02 15:24:00,704 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Single file workflow.
2025-05-02 15:24:00,721 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Compressed size: 81577
2025-05-02 15:24:00,725 - INFO - [Upload_feda_0] [_send_single_file_task] - [fedadb2f-1972-4708-9a8a-0612e37d6493] T> Sending 'image (12).zip' (81577b) to -4603853425
2025-05-02 15:24:00,726 - INFO - [Upload_feda_1] [_send_single_file_task] - [fedadb2f-1972-4708-9a8a-0612e37d6493] T> Sending 'image (12).zip' (81577b) to -1002614397019
2025-05-02 15:24:00,726 - INFO - [Upload_feda_0] [send_file_to_telegram] - [ChatID -4603853425, File 'image (12).zip'] Attempting send.
2025-05-02 15:24:00,726 - INFO - [Upload_feda_2] [_send_single_file_task] - [fedadb2f-1972-4708-9a8a-0612e37d6493] T> Sending 'image (12).zip' (81577b) to -4641852757
2025-05-02 15:24:00,727 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Submitted 3 single-file tasks.
2025-05-02 15:24:00,727 - INFO - [Upload_feda_1] [send_file_to_telegram] - [ChatID -1002614397019, File 'image (12).zip'] Attempting send.
2025-05-02 15:24:00,732 - INFO - [Upload_feda_2] [send_file_to_telegram] - [ChatID -4641852757, File 'image (12).zip'] Attempting send.
2025-05-02 15:24:00,733 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Wait primary (-4603853425)...
2025-05-02 15:24:02,007 - INFO - [Upload_feda_2] [send_file_to_telegram] - [ChatID -4641852757, File 'image (12).zip'] API success (Attempt 1).
2025-05-02 15:24:02,008 - INFO - [Upload_feda_2] [_send_single_file_task] - [fedadb2f-1972-4708-9a8a-0612e37d6493] T> Sent 'image (12).zip' to -4641852757. Success: True
2025-05-02 15:24:02,011 - INFO - [Upload_feda_1] [send_file_to_telegram] - [ChatID -1002614397019, File 'image (12).zip'] API success (Attempt 1).
2025-05-02 15:24:02,012 - INFO - [Upload_feda_1] [_send_single_file_task] - [fedadb2f-1972-4708-9a8a-0612e37d6493] T> Sent 'image (12).zip' to -1002614397019. Success: True
2025-05-02 15:24:02,059 - INFO - [Upload_feda_0] [send_file_to_telegram] - [ChatID -4603853425, File 'image (12).zip'] API success (Attempt 1).
2025-05-02 15:24:02,060 - INFO - [Upload_feda_0] [_send_single_file_task] - [fedadb2f-1972-4708-9a8a-0612e37d6493] T> Sent 'image (12).zip' to -4603853425. Success: True
2025-05-02 15:24:02,060 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Primary done. OK:True
2025-05-02 15:24:02,061 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Wait backups...
2025-05-02 15:24:02,061 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Single sends done in 1.34s.
2025-05-02 15:24:02,062 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Success: 3/3
2025-05-02 15:24:02,063 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Attempting to save metadata to DB...
2025-05-02 15:24:02,064 - ERROR - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Upload failed: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\routes.py", line 390, in process_upload_and_generate_updates
    save_success, save_msg = save_file_metadata(record) # Call the DB function
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 142, in save_file_metadata
    collection, error = get_metadata_collection()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 116, in get_metadata_collection
    db_instance, error = get_db()
                         ^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 91, in get_db
    if _db:
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\database.py", line 342, in __bool__
    raise NotImplementedError(
NotImplementedError: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-05-02 15:24:02,069 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Upload generator cleanup.
2025-05-02 15:24:02,070 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Upload executor shutdown.
2025-05-02 15:24:02,071 - INFO - [Thread-17 (process_request_thread)] [_safe_remove_file] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Cleaned up original temp: uploads_temp\fedadb2f-1972-4708-9a8a-0612e37d6493_image (12).png
2025-05-02 15:24:02,071 - INFO - [Thread-17 (process_request_thread)] [process_upload_and_generate_updates] - [fedadb2f-1972-4708-9a8a-0612e37d6493] Upload generator finished. Status: error
2025-05-02 15:24:03,952 - INFO - [Thread-18 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:03] "GET /login HTTP/1.1" 200 -
2025-05-02 15:24:24,522 - INFO - [Thread-19 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:24] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-05-02 15:24:24,527 - INFO - [Thread-20 (process_request_thread)] [index] - Serving index page.
2025-05-02 15:24:24,528 - INFO - [Thread-20 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:24] "GET / HTTP/1.1" 200 -
2025-05-02 15:24:28,593 - INFO - [Thread-21 (process_request_thread)] [initiate_upload] - Request initiate upload.
2025-05-02 15:24:28,594 - INFO - [Thread-21 (process_request_thread)] [initiate_upload] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Temp storage: uploads_temp\c94f44ac-a1ad-4038-b605-98ae986c9e4f_gitattributes (4) (1)
2025-05-02 15:24:28,595 - INFO - [Thread-21 (process_request_thread)] [initiate_upload] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Temp saved: 'gitattributes (4) (1)'.
2025-05-02 15:24:28,596 - INFO - [Thread-21 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:28] "POST /initiate-upload HTTP/1.1" 200 -
2025-05-02 15:24:28,601 - INFO - [Thread-22 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: c94f44ac-a1ad-4038-b605-98ae986c9e4f
2025-05-02 15:24:28,601 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Starting processing generator...
2025-05-02 15:24:28,602 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Processing: User='admin', File='gitattributes (4) (1)'
2025-05-02 15:24:28,602 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Initialized Upload Executor (max=5)
2025-05-02 15:24:28,605 - INFO - [Thread-22 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:28] "GET /stream-progress/c94f44ac-a1ad-4038-b605-98ae986c9e4f HTTP/1.1" 200 -
2025-05-02 15:24:28,607 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Access ID: d2ec941179
2025-05-02 15:24:28,609 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Single file workflow.
2025-05-02 15:24:28,611 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Compressed size: 202
2025-05-02 15:24:28,613 - INFO - [Upload_c94f_0] [_send_single_file_task] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] T> Sending 'gitattributes (4) (1).zip' (202b) to -4603853425
2025-05-02 15:24:28,613 - INFO - [Upload_c94f_0] [send_file_to_telegram] - [ChatID -4603853425, File 'gitattributes (4) (1).zip'] Attempting send.
2025-05-02 15:24:28,613 - INFO - [Upload_c94f_1] [_send_single_file_task] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] T> Sending 'gitattributes (4) (1).zip' (202b) to -1002614397019
2025-05-02 15:24:28,615 - INFO - [Upload_c94f_1] [send_file_to_telegram] - [ChatID -1002614397019, File 'gitattributes (4) (1).zip'] Attempting send.
2025-05-02 15:24:28,615 - INFO - [Upload_c94f_2] [_send_single_file_task] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] T> Sending 'gitattributes (4) (1).zip' (202b) to -4641852757
2025-05-02 15:24:28,615 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Submitted 3 single-file tasks.
2025-05-02 15:24:28,617 - INFO - [Upload_c94f_2] [send_file_to_telegram] - [ChatID -4641852757, File 'gitattributes (4) (1).zip'] Attempting send.
2025-05-02 15:24:28,617 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Wait primary (-4603853425)...
2025-05-02 15:24:29,118 - INFO - [Upload_c94f_0] [send_file_to_telegram] - [ChatID -4603853425, File 'gitattributes (4) (1).zip'] API success (Attempt 1).
2025-05-02 15:24:29,119 - INFO - [Upload_c94f_2] [send_file_to_telegram] - [ChatID -4641852757, File 'gitattributes (4) (1).zip'] API success (Attempt 1).
2025-05-02 15:24:29,119 - INFO - [Upload_c94f_0] [_send_single_file_task] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] T> Sent 'gitattributes (4) (1).zip' to -4603853425. Success: True
2025-05-02 15:24:29,120 - INFO - [Upload_c94f_2] [_send_single_file_task] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] T> Sent 'gitattributes (4) (1).zip' to -4641852757. Success: True
2025-05-02 15:24:29,120 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Primary done. OK:True
2025-05-02 15:24:29,121 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Wait backups...
2025-05-02 15:24:29,129 - INFO - [Upload_c94f_1] [send_file_to_telegram] - [ChatID -1002614397019, File 'gitattributes (4) (1).zip'] API success (Attempt 1).
2025-05-02 15:24:29,130 - INFO - [Upload_c94f_1] [_send_single_file_task] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] T> Sent 'gitattributes (4) (1).zip' to -1002614397019. Success: True
2025-05-02 15:24:29,131 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Single sends done in 0.52s.
2025-05-02 15:24:29,131 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Success: 3/3
2025-05-02 15:24:29,132 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Attempting to save metadata to DB...
2025-05-02 15:24:29,135 - ERROR - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Upload failed: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\routes.py", line 390, in process_upload_and_generate_updates
    save_success, save_msg = save_file_metadata(record) # Call the DB function
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 142, in save_file_metadata
    collection, error = get_metadata_collection()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 116, in get_metadata_collection
    db_instance, error = get_db()
                         ^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 91, in get_db
    if _db:
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\database.py", line 342, in __bool__
    raise NotImplementedError(
NotImplementedError: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-05-02 15:24:29,142 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Upload generator cleanup.
2025-05-02 15:24:29,146 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Upload executor shutdown.
2025-05-02 15:24:29,197 - INFO - [Thread-22 (process_request_thread)] [_safe_remove_file] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Cleaned up original temp: uploads_temp\c94f44ac-a1ad-4038-b605-98ae986c9e4f_gitattributes (4) (1)
2025-05-02 15:24:29,219 - INFO - [Thread-22 (process_request_thread)] [process_upload_and_generate_updates] - [c94f44ac-a1ad-4038-b605-98ae986c9e4f] Upload generator finished. Status: error
2025-05-02 15:24:34,498 - INFO - [Thread-23 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:34] "GET /login HTTP/1.1" 200 -
2025-05-02 15:24:41,118 - INFO - [Thread-24 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:41] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-05-02 15:24:41,124 - INFO - [Thread-25 (process_request_thread)] [index] - Serving index page.
2025-05-02 15:24:41,127 - INFO - [Thread-25 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:41] "GET / HTTP/1.1" 200 -
2025-05-02 15:24:43,758 - INFO - [Thread-26 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:43] "GET /login HTTP/1.1" 200 -
2025-05-02 15:24:47,954 - INFO - [Thread-28 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:47] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-05-02 15:24:47,958 - INFO - [Thread-27 (process_request_thread)] [index] - Serving index page.
2025-05-02 15:24:47,959 - INFO - [Thread-27 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:47] "GET / HTTP/1.1" 200 -
2025-05-02 15:24:57,205 - INFO - [Thread-29 (process_request_thread)] [initiate_upload] - Request initiate upload.
2025-05-02 15:24:57,207 - INFO - [Thread-29 (process_request_thread)] [initiate_upload] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Temp storage: uploads_temp\fb008b8d-b788-4dc2-b87d-d3e1817912c7_image (12).png
2025-05-02 15:24:57,208 - INFO - [Thread-29 (process_request_thread)] [initiate_upload] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Temp saved: 'image (12).png'.
2025-05-02 15:24:57,210 - INFO - [Thread-29 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:57] "POST /initiate-upload HTTP/1.1" 200 -
2025-05-02 15:24:57,215 - INFO - [Thread-30 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: fb008b8d-b788-4dc2-b87d-d3e1817912c7
2025-05-02 15:24:57,216 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Starting processing generator...
2025-05-02 15:24:57,216 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Processing: User='admin', File='image (12).png'
2025-05-02 15:24:57,217 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Initialized Upload Executor (max=5)
2025-05-02 15:24:57,217 - INFO - [Thread-30 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 15:24:57] "GET /stream-progress/fb008b8d-b788-4dc2-b87d-d3e1817912c7 HTTP/1.1" 200 -
2025-05-02 15:24:57,218 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Access ID: a22e3d075d
2025-05-02 15:24:57,219 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Single file workflow.
2025-05-02 15:24:57,239 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Compressed size: 81577
2025-05-02 15:24:57,242 - INFO - [Upload_fb00_0] [_send_single_file_task] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] T> Sending 'image (12).zip' (81577b) to -4603853425
2025-05-02 15:24:57,244 - INFO - [Upload_fb00_1] [_send_single_file_task] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] T> Sending 'image (12).zip' (81577b) to -1002614397019
2025-05-02 15:24:57,244 - INFO - [Upload_fb00_0] [send_file_to_telegram] - [ChatID -4603853425, File 'image (12).zip'] Attempting send.
2025-05-02 15:24:57,244 - INFO - [Upload_fb00_2] [_send_single_file_task] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] T> Sending 'image (12).zip' (81577b) to -4641852757
2025-05-02 15:24:57,244 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Submitted 3 single-file tasks.
2025-05-02 15:24:57,245 - INFO - [Upload_fb00_1] [send_file_to_telegram] - [ChatID -1002614397019, File 'image (12).zip'] Attempting send.
2025-05-02 15:24:57,246 - INFO - [Upload_fb00_2] [send_file_to_telegram] - [ChatID -4641852757, File 'image (12).zip'] Attempting send.
2025-05-02 15:24:57,247 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Wait primary (-4603853425)...
2025-05-02 15:24:57,938 - INFO - [Upload_fb00_1] [send_file_to_telegram] - [ChatID -1002614397019, File 'image (12).zip'] API success (Attempt 1).
2025-05-02 15:24:57,938 - INFO - [Upload_fb00_1] [_send_single_file_task] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] T> Sent 'image (12).zip' to -1002614397019. Success: True
2025-05-02 15:24:58,084 - INFO - [Upload_fb00_0] [send_file_to_telegram] - [ChatID -4603853425, File 'image (12).zip'] API success (Attempt 1).
2025-05-02 15:24:58,084 - INFO - [Upload_fb00_0] [_send_single_file_task] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] T> Sent 'image (12).zip' to -4603853425. Success: True
2025-05-02 15:24:58,084 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Primary done. OK:True
2025-05-02 15:24:58,085 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Wait backups...
2025-05-02 15:24:58,194 - INFO - [Upload_fb00_2] [send_file_to_telegram] - [ChatID -4641852757, File 'image (12).zip'] API success (Attempt 1).
2025-05-02 15:24:58,195 - INFO - [Upload_fb00_2] [_send_single_file_task] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] T> Sent 'image (12).zip' to -4641852757. Success: True
2025-05-02 15:24:58,195 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Single sends done in 0.95s.
2025-05-02 15:24:58,195 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Success: 3/3
2025-05-02 15:24:58,196 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Attempting to save metadata to DB...
2025-05-02 15:24:58,197 - ERROR - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Upload failed: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\routes.py", line 390, in process_upload_and_generate_updates
    save_success, save_msg = save_file_metadata(record) # Call the DB function
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 142, in save_file_metadata
    collection, error = get_metadata_collection()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 116, in get_metadata_collection
    db_instance, error = get_db()
                         ^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 91, in get_db
    if _db:
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\database.py", line 342, in __bool__
    raise NotImplementedError(
NotImplementedError: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-05-02 15:24:58,200 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Upload generator cleanup.
2025-05-02 15:24:58,201 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Upload executor shutdown.
2025-05-02 15:24:58,202 - INFO - [Thread-30 (process_request_thread)] [_safe_remove_file] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Cleaned up original temp: uploads_temp\fb008b8d-b788-4dc2-b87d-d3e1817912c7_image (12).png
2025-05-02 15:24:58,202 - INFO - [Thread-30 (process_request_thread)] [process_upload_and_generate_updates] - [fb008b8d-b788-4dc2-b87d-d3e1817912c7] Upload generator finished. Status: error
2025-05-02 15:35:46,759 - INFO - [MainThread] [_log] -  * Detected change in 'E:\\Telegram_tool\\Telegram_Bot_Tool\\database.py', reloading
