2025-05-01 09:40:35,217 - INFO - [MainThread] [<module>] - ============================================================
2025-05-01 09:40:35,217 - INFO - [MainThread] [<module>] - Logging configured. Level: INFO. Log file: Selenium-Logs\app_20250501_094035.log
2025-05-01 09:40:35,217 - INFO - [MainThread] [<module>] - Primary Chat ID: -4603853425
2025-05-01 09:40:35,218 - INFO - [MainThread] [<module>] - All Target Chat IDs: ['-4603853425']
2025-05-01 09:40:35,218 - WARNING - [MainThread] [format_bytes] - Error formatting bytes (20971520): name 'math' is not defined
2025-05-01 09:40:35,218 - INFO - [MainThread] [<module>] - Chunk Size: 20971520 B (20971520 bytes)
2025-05-01 09:40:35,218 - INFO - [MainThread] [<module>] - API Timeouts (Connect/Read): 10s / 60s
2025-05-01 09:40:35,219 - INFO - [MainThread] [<module>] - API Retries: 3 attempts, 2s delay
2025-05-01 09:40:35,219 - INFO - [MainThread] [<module>] - Max Upload Workers: 3
2025-05-01 09:40:35,219 - INFO - [MainThread] [<module>] - Max Download Workers: 12
2025-05-01 09:40:35,220 - INFO - [MainThread] [<module>] - ============================================================
2025-05-01 09:40:35,220 - INFO - [MainThread] [<module>] - Configuration loaded successfully.
2025-05-01 09:40:35,221 - INFO - [MainThread] [<module>] - Custom Jinja filter 'format_bytes' registered.
2025-05-01 09:40:35,221 - INFO - [MainThread] [<module>] - Flask-CORS initialized. Allowing origins: http://localhost:4200
2025-05-01 09:40:35,222 - INFO - [MainThread] [<module>] - Flask application initialized.
2025-05-01 09:40:35,222 - INFO - [MainThread] [<module>] - Global state variables initialized (upload_progress_data, download_prep_data).
2025-05-01 09:40:35,224 - INFO - [MainThread] [<module>] - Custom Jinja filter 'format_bytes' registered.
2025-05-01 09:40:35,224 - INFO - [MainThread] [<module>] - Flask-CORS initialized. Allowing origins: http://localhost:4200
2025-05-01 09:40:35,225 - INFO - [MainThread] [<module>] - Flask application initialized.
2025-05-01 09:40:35,226 - INFO - [MainThread] [<module>] - Global state variables initialized (upload_progress_data, download_prep_data).
2025-05-01 09:40:35,383 - INFO - [MainThread] [<module>] - Database module initialized.
2025-05-01 09:40:35,829 - INFO - [MainThread] [<module>] - Initialized requests.Session for Telegram API calls.
2025-05-01 09:40:35,829 - INFO - [MainThread] [<module>] - Telegram API functions defined with Session and Retries.
2025-05-01 09:40:35,834 - INFO - [MainThread] [<module>] - Flask routes defined using configurable workers and linter fixes.
2025-05-01 09:40:35,834 - INFO - [MainThread] [<module>] - Starting Flask development server...
2025-05-01 09:40:35,852 - WARNING - [MainThread] [_log] -  * Debugger is active!
2025-05-01 09:40:35,858 - INFO - [MainThread] [_log] -  * Debugger PIN: 107-410-311
2025-05-01 09:40:39,478 - INFO - [Thread-3 (process_request_thread)] [index] - Serving index page.
2025-05-01 09:40:39,496 - INFO - [Thread-3 (process_request_thread)] [_log] - 127.0.0.1 - - [01/May/2025 09:40:39] "GET / HTTP/1.1" 200 -
2025-05-01 09:40:45,302 - INFO - [Thread-2 (process_request_thread)] [initiate_upload] - Request initiate upload.
2025-05-01 09:40:45,303 - INFO - [Thread-2 (process_request_thread)] [initiate_upload] - [a6939a47-7513-42f2-b489-804703e4a995] Temp storage: uploads_temp\a6939a47-7513-42f2-b489-804703e4a995_404_error.html
2025-05-01 09:40:45,304 - INFO - [Thread-2 (process_request_thread)] [initiate_upload] - [a6939a47-7513-42f2-b489-804703e4a995] Temp saved: '404_error.html'.
2025-05-01 09:40:45,306 - INFO - [Thread-2 (process_request_thread)] [_log] - 127.0.0.1 - - [01/May/2025 09:40:45] "POST /initiate-upload HTTP/1.1" 200 -
2025-05-01 09:40:45,313 - INFO - [Thread-4 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: a6939a47-7513-42f2-b489-804703e4a995
2025-05-01 09:40:45,314 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] Starting processing generator...
2025-05-01 09:40:45,315 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] Processing: User='ELENA', File='404_error.html'
2025-05-01 09:40:45,315 - INFO - [Thread-4 (process_request_thread)] [_log] - 127.0.0.1 - - [01/May/2025 09:40:45] "GET /stream-progress/a6939a47-7513-42f2-b489-804703e4a995 HTTP/1.1" 200 -
2025-05-01 09:40:45,316 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] Access ID: 197e92137e
2025-05-01 09:40:45,320 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] Single file workflow.
2025-05-01 09:40:45,323 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] Compressed size: 917
2025-05-01 09:40:45,324 - INFO - [Thread-4 (process_request_thread)] [_send_single_file_task] - [a6939a47-7513-42f2-b489-804703e4a995] T> Sending '404_error.zip' (917b) to -4603853425
2025-05-01 09:40:45,326 - INFO - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File '404_error.zip'] Attempting send.
2025-05-01 09:40:46,340 - INFO - [Thread-4 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File '404_error.zip'] API success (Attempt 1).
2025-05-01 09:40:46,340 - INFO - [Thread-4 (process_request_thread)] [_send_single_file_task] - [a6939a47-7513-42f2-b489-804703e4a995] T> Sent '404_error.zip' to -4603853425. Success: True
2025-05-01 09:40:46,341 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] Single sends done in 1.02s.
2025-05-01 09:40:46,341 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] Success: 1/1
2025-05-01 09:40:46,342 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] Attempting to save metadata to DB...
2025-05-01 09:40:46,342 - INFO - [Thread-4 (process_request_thread)] [_connect_to_db] - Attempting to connect to MongoDB Atlas host: telegrambot.sfoz7jc.mongodb.net...
2025-05-01 09:40:46,613 - ERROR - [Thread-4 (process_request_thread)] [_connect_to_db] - An unexpected error occurred during MongoDB connection: The DNS query name does not exist: _mongodb._tcp.telegrambot.sfoz7jc.mongodb.net.
Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 69, in _connect_to_db
    client = MongoClient(CONNECTION_STRING, server_api=ServerApi('1'))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 884, in __init__
    self._get_topology()  # type: ignore[unused-coroutine]
    ^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 1737, in _get_topology
    self._resolve_srv()
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 903, in _resolve_srv
    res = uri_parser._parse_srv(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\uri_parser.py", line 163, in _parse_srv
    nodes = dns_resolver.get_hosts()
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\srv_resolver.py", line 157, in get_hosts
    _, nodes = self._get_srv_response_and_hosts(True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\srv_resolver.py", line 131, in _get_srv_response_and_hosts
    results = self._resolve_uri(encapsulate_errors)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\srv_resolver.py", line 125, in _resolve_uri
    raise ConfigurationError(str(exc)) from None
pymongo.errors.ConfigurationError: The DNS query name does not exist: _mongodb._tcp.telegrambot.sfoz7jc.mongodb.net.
2025-05-01 09:40:46,618 - ERROR - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] CRITICAL: Metadata save to DB failed: Failed to get collection: An unexpected error occurred during MongoDB connection: The DNS query name does not exist: _mongodb._tcp.telegrambot.sfoz7jc.mongodb.net.
2025-05-01 09:40:46,619 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] Upload generator cleanup.
2025-05-01 09:40:46,621 - INFO - [Thread-4 (process_request_thread)] [_safe_remove_file] - [a6939a47-7513-42f2-b489-804703e4a995] Cleaned up original temp: uploads_temp\a6939a47-7513-42f2-b489-804703e4a995_404_error.html
2025-05-01 09:40:46,622 - INFO - [Thread-4 (process_request_thread)] [process_upload_and_generate_updates] - [a6939a47-7513-42f2-b489-804703e4a995] Upload generator finished. Status: processing
2025-05-01 09:41:04,055 - INFO - [Thread-5 (process_request_thread)] [initiate_upload] - Request initiate upload.
2025-05-01 09:41:04,057 - INFO - [Thread-5 (process_request_thread)] [initiate_upload] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Temp storage: uploads_temp\7e05bf1e-770d-4ddc-96f7-79dbec15cb90_404_error.html
2025-05-01 09:41:04,058 - INFO - [Thread-5 (process_request_thread)] [initiate_upload] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Temp saved: '404_error.html'.
2025-05-01 09:41:04,059 - INFO - [Thread-5 (process_request_thread)] [_log] - 127.0.0.1 - - [01/May/2025 09:41:04] "POST /initiate-upload HTTP/1.1" 200 -
2025-05-01 09:41:04,064 - INFO - [Thread-6 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: 7e05bf1e-770d-4ddc-96f7-79dbec15cb90
2025-05-01 09:41:04,064 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Starting processing generator...
2025-05-01 09:41:04,065 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Processing: User='ELENA', File='404_error.html'
2025-05-01 09:41:04,066 - INFO - [Thread-6 (process_request_thread)] [_log] - 127.0.0.1 - - [01/May/2025 09:41:04] "GET /stream-progress/7e05bf1e-770d-4ddc-96f7-79dbec15cb90 HTTP/1.1" 200 -
2025-05-01 09:41:04,068 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Access ID: 0de5e84f0a
2025-05-01 09:41:04,069 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Single file workflow.
2025-05-01 09:41:04,072 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Compressed size: 917
2025-05-01 09:41:04,073 - INFO - [Thread-6 (process_request_thread)] [_send_single_file_task] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] T> Sending '404_error.zip' (917b) to -4603853425
2025-05-01 09:41:04,073 - INFO - [Thread-6 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File '404_error.zip'] Attempting send.
2025-05-01 09:41:04,732 - INFO - [Thread-6 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File '404_error.zip'] API success (Attempt 1).
2025-05-01 09:41:04,732 - INFO - [Thread-6 (process_request_thread)] [_send_single_file_task] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] T> Sent '404_error.zip' to -4603853425. Success: True
2025-05-01 09:41:04,733 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Single sends done in 0.66s.
2025-05-01 09:41:04,733 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Success: 1/1
2025-05-01 09:41:04,734 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Attempting to save metadata to DB...
2025-05-01 09:41:04,734 - INFO - [Thread-6 (process_request_thread)] [_connect_to_db] - Attempting to connect to MongoDB Atlas host: telegrambot.sfoz7jc.mongodb.net...
2025-05-01 09:41:04,740 - ERROR - [Thread-6 (process_request_thread)] [_connect_to_db] - An unexpected error occurred during MongoDB connection: The DNS query name does not exist: _mongodb._tcp.telegrambot.sfoz7jc.mongodb.net.
Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 69, in _connect_to_db
    client = MongoClient(CONNECTION_STRING, server_api=ServerApi('1'))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 884, in __init__
    self._get_topology()  # type: ignore[unused-coroutine]
    ^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 1737, in _get_topology
    self._resolve_srv()
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 903, in _resolve_srv
    res = uri_parser._parse_srv(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\uri_parser.py", line 163, in _parse_srv
    nodes = dns_resolver.get_hosts()
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\srv_resolver.py", line 157, in get_hosts
    _, nodes = self._get_srv_response_and_hosts(True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\srv_resolver.py", line 131, in _get_srv_response_and_hosts
    results = self._resolve_uri(encapsulate_errors)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\srv_resolver.py", line 125, in _resolve_uri
    raise ConfigurationError(str(exc)) from None
pymongo.errors.ConfigurationError: The DNS query name does not exist: _mongodb._tcp.telegrambot.sfoz7jc.mongodb.net.
2025-05-01 09:41:04,743 - ERROR - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] CRITICAL: Metadata save to DB failed: Failed to get collection: An unexpected error occurred during MongoDB connection: The DNS query name does not exist: _mongodb._tcp.telegrambot.sfoz7jc.mongodb.net.
2025-05-01 09:41:04,743 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Upload generator cleanup.
2025-05-01 09:41:04,744 - INFO - [Thread-6 (process_request_thread)] [_safe_remove_file] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Cleaned up original temp: uploads_temp\7e05bf1e-770d-4ddc-96f7-79dbec15cb90_404_error.html
2025-05-01 09:41:04,745 - INFO - [Thread-6 (process_request_thread)] [process_upload_and_generate_updates] - [7e05bf1e-770d-4ddc-96f7-79dbec15cb90] Upload generator finished. Status: processing
