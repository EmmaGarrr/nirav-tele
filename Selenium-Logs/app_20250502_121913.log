2025-05-02 12:19:13,613 - INFO - [MainThread] [<module>] - ============================================================
2025-05-02 12:19:13,613 - INFO - [MainThread] [<module>] - Logging configured. Level: INFO. Log file: Selenium-Logs\app_20250502_121913.log
2025-05-02 12:19:13,618 - INFO - [MainThread] [<module>] - Primary Chat ID: -4603853425
2025-05-02 12:19:13,618 - INFO - [MainThread] [<module>] - All Target Chat IDs: ['-4603853425', '-1002614397019', '-4641852757']
2025-05-02 12:19:13,618 - INFO - [MainThread] [<module>] - Chunk Size: 20.0 MB (20971520 bytes)
2025-05-02 12:19:13,618 - INFO - [MainThread] [<module>] - API Timeouts (Connect/Read): 10s / 60s
2025-05-02 12:19:13,618 - INFO - [MainThread] [<module>] - API Retries: 3 attempts, 2s delay
2025-05-02 12:19:13,618 - INFO - [MainThread] [<module>] - Max Upload Workers: 5
2025-05-02 12:19:13,618 - INFO - [MainThread] [<module>] - Max Download Workers: 12
2025-05-02 12:19:13,618 - INFO - [MainThread] [<module>] - ============================================================
2025-05-02 12:19:13,618 - INFO - [MainThread] [<module>] - Configuration loaded successfully.
2025-05-02 12:19:13,618 - INFO - [MainThread] [<module>] - Custom Jinja filter 'format_bytes' registered.
2025-05-02 12:19:13,622 - INFO - [MainThread] [<module>] - Flask-CORS initialized. Allowing origins: http://localhost:4200
2025-05-02 12:19:13,622 - INFO - [MainThread] [<module>] - Flask application initialized.
2025-05-02 12:19:13,622 - INFO - [MainThread] [<module>] - Global state variables initialized (upload_progress_data, download_prep_data).
2025-05-02 12:19:13,626 - INFO - [MainThread] [<module>] - Custom Jinja filter 'format_bytes' registered.
2025-05-02 12:19:13,628 - INFO - [MainThread] [<module>] - Flask-CORS initialized. Allowing origins: http://localhost:4200
2025-05-02 12:19:13,632 - INFO - [MainThread] [<module>] - Flask application initialized.
2025-05-02 12:19:13,632 - INFO - [MainThread] [<module>] - Global state variables initialized (upload_progress_data, download_prep_data).
2025-05-02 12:19:13,818 - INFO - [MainThread] [<module>] - Database module initialized.
2025-05-02 12:19:14,297 - INFO - [MainThread] [<module>] - Initialized requests.Session for Telegram API calls.
2025-05-02 12:19:14,297 - INFO - [MainThread] [<module>] - Telegram API functions defined with Session and Retries.
2025-05-02 12:19:14,302 - INFO - [MainThread] [<module>] - Flask routes defined using configurable workers and linter fixes.
2025-05-02 12:19:14,303 - INFO - [MainThread] [<module>] - Starting Flask development server...
2025-05-02 12:19:14,328 - WARNING - [MainThread] [_log] -  * Debugger is active!
2025-05-02 12:19:14,333 - INFO - [MainThread] [_log] -  * Debugger PIN: 107-410-311
2025-05-02 12:19:22,914 - INFO - [Thread-2 (process_request_thread)] [show_register_page] - Serving registration page.
2025-05-02 12:19:22,968 - INFO - [Thread-2 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 12:19:22] "GET /register HTTP/1.1" 200 -
2025-05-02 12:19:45,913 - INFO - [Thread-4 (process_request_thread)] [register_user] - Received registration request.
2025-05-02 12:19:45,913 - INFO - [Thread-4 (process_request_thread)] [_connect_to_db] - Attempting to connect to MongoDB Atlas host: telegrambot.6armfs2.mongodb.net...
2025-05-02 12:19:46,713 - INFO - [Thread-4 (process_request_thread)] [_connect_to_db] - âœ… Successfully connected and pinged MongoDB Atlas!
2025-05-02 12:19:46,713 - INFO - [Thread-4 (process_request_thread)] [get_db] - Accessed database: Telegrambot
2025-05-02 12:19:46,713 - INFO - [Thread-4 (process_request_thread)] [get_userinfo_collection] - Accessed collection: userinfo
2025-05-02 12:19:46,740 - INFO - [Thread-4 (process_request_thread)] [find_user_by_email] - No user record found for email: test1@email.com
2025-05-02 12:19:47,653 - INFO - [Thread-4 (process_request_thread)] [save_user] - Successfully inserted new user with ID: 68146b0bd2f1692d5db9614d
2025-05-02 12:19:47,653 - INFO - [Thread-4 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 12:19:47] "[35m[1mPOST /register HTTP/1.1[0m" 201 -
2025-05-02 12:20:25,893 - INFO - [Thread-6 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 12:20:25] "GET /login HTTP/1.1" 200 -
2025-05-02 12:20:33,585 - INFO - [Thread-7 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 12:20:33] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-05-02 12:20:33,594 - INFO - [Thread-8 (process_request_thread)] [index] - Serving index page.
2025-05-02 12:20:33,608 - INFO - [Thread-8 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 12:20:33] "GET / HTTP/1.1" 200 -
2025-05-02 12:20:45,938 - INFO - [Thread-9 (process_request_thread)] [initiate_upload] - Request initiate upload.
2025-05-02 12:20:45,940 - INFO - [Thread-9 (process_request_thread)] [initiate_upload] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Temp storage: uploads_temp\a057dcc5-23e0-45bc-908d-680d34f348bb_404_error.html
2025-05-02 12:20:45,941 - INFO - [Thread-9 (process_request_thread)] [initiate_upload] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Temp saved: '404_error.html'.
2025-05-02 12:20:45,942 - INFO - [Thread-9 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 12:20:45] "POST /initiate-upload HTTP/1.1" 200 -
2025-05-02 12:20:45,969 - INFO - [Thread-10 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: a057dcc5-23e0-45bc-908d-680d34f348bb
2025-05-02 12:20:45,970 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Starting processing generator...
2025-05-02 12:20:45,970 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Processing: User='admin', File='404_error.html'
2025-05-02 12:20:45,972 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Initialized Upload Executor (max=5)
2025-05-02 12:20:45,972 - INFO - [Thread-10 (process_request_thread)] [_log] - 127.0.0.1 - - [02/May/2025 12:20:45] "GET /stream-progress/a057dcc5-23e0-45bc-908d-680d34f348bb HTTP/1.1" 200 -
2025-05-02 12:20:45,974 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Access ID: 229fbc0f70
2025-05-02 12:20:45,976 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Single file workflow.
2025-05-02 12:20:45,979 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Compressed size: 917
2025-05-02 12:20:45,988 - INFO - [Upload_a057_0] [_send_single_file_task] - [a057dcc5-23e0-45bc-908d-680d34f348bb] T> Sending '404_error.zip' (917b) to -4603853425
2025-05-02 12:20:45,992 - INFO - [Upload_a057_0] [send_file_to_telegram] - [ChatID -4603853425, File '404_error.zip'] Attempting send.
2025-05-02 12:20:45,992 - INFO - [Upload_a057_1] [_send_single_file_task] - [a057dcc5-23e0-45bc-908d-680d34f348bb] T> Sending '404_error.zip' (917b) to -1002614397019
2025-05-02 12:20:45,994 - INFO - [Upload_a057_2] [_send_single_file_task] - [a057dcc5-23e0-45bc-908d-680d34f348bb] T> Sending '404_error.zip' (917b) to -4641852757
2025-05-02 12:20:45,994 - INFO - [Upload_a057_1] [send_file_to_telegram] - [ChatID -1002614397019, File '404_error.zip'] Attempting send.
2025-05-02 12:20:45,995 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Submitted 3 single-file tasks.
2025-05-02 12:20:45,995 - INFO - [Upload_a057_2] [send_file_to_telegram] - [ChatID -4641852757, File '404_error.zip'] Attempting send.
2025-05-02 12:20:45,996 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Wait primary (-4603853425)...
2025-05-02 12:20:46,971 - INFO - [Upload_a057_0] [send_file_to_telegram] - [ChatID -4603853425, File '404_error.zip'] API success (Attempt 1).
2025-05-02 12:20:46,972 - INFO - [Upload_a057_0] [_send_single_file_task] - [a057dcc5-23e0-45bc-908d-680d34f348bb] T> Sent '404_error.zip' to -4603853425. Success: True
2025-05-02 12:20:46,973 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Primary done. OK:True
2025-05-02 12:20:46,973 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Wait backups...
2025-05-02 12:20:46,986 - INFO - [Upload_a057_2] [send_file_to_telegram] - [ChatID -4641852757, File '404_error.zip'] API success (Attempt 1).
2025-05-02 12:20:46,988 - INFO - [Upload_a057_2] [_send_single_file_task] - [a057dcc5-23e0-45bc-908d-680d34f348bb] T> Sent '404_error.zip' to -4641852757. Success: True
2025-05-02 12:20:47,005 - INFO - [Upload_a057_1] [send_file_to_telegram] - [ChatID -1002614397019, File '404_error.zip'] API success (Attempt 1).
2025-05-02 12:20:47,006 - INFO - [Upload_a057_1] [_send_single_file_task] - [a057dcc5-23e0-45bc-908d-680d34f348bb] T> Sent '404_error.zip' to -1002614397019. Success: True
2025-05-02 12:20:47,006 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Single sends done in 1.03s.
2025-05-02 12:20:47,007 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Success: 3/3
2025-05-02 12:20:47,008 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Attempting to save metadata to DB...
2025-05-02 12:20:47,009 - ERROR - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Upload failed: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\routes.py", line 390, in process_upload_and_generate_updates
    save_success, save_msg = save_file_metadata(record) # Call the DB function
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 142, in save_file_metadata
    collection, error = get_metadata_collection()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 116, in get_metadata_collection
    db_instance, error = get_db()
                         ^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 91, in get_db
    if _db:
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\database.py", line 342, in __bool__
    raise NotImplementedError(
NotImplementedError: Database objects do not implement truth value testing or bool(). Please compare with None instead: database is not None
2025-05-02 12:20:47,013 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Upload generator cleanup.
2025-05-02 12:20:47,016 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Upload executor shutdown.
2025-05-02 12:20:47,018 - INFO - [Thread-10 (process_request_thread)] [_safe_remove_file] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Cleaned up original temp: uploads_temp\a057dcc5-23e0-45bc-908d-680d34f348bb_404_error.html
2025-05-02 12:20:47,038 - INFO - [Thread-10 (process_request_thread)] [process_upload_and_generate_updates] - [a057dcc5-23e0-45bc-908d-680d34f348bb] Upload generator finished. Status: error
