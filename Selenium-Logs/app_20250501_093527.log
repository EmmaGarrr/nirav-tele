2025-05-01 09:35:27,941 - INFO - [MainThread] [<module>] - ============================================================
2025-05-01 09:35:27,941 - INFO - [MainThread] [<module>] - Logging configured. Level: INFO. Log file: Selenium-Logs\app_20250501_093527.log
2025-05-01 09:35:27,942 - INFO - [MainThread] [<module>] - Primary Chat ID: -4603853425
2025-05-01 09:35:27,942 - INFO - [MainThread] [<module>] - All Target Chat IDs: ['-4603853425']
2025-05-01 09:35:27,942 - WARNING - [MainThread] [format_bytes] - Error formatting bytes (20971520): name 'math' is not defined
2025-05-01 09:35:27,943 - INFO - [MainThread] [<module>] - Chunk Size: 20971520 B (20971520 bytes)
2025-05-01 09:35:27,943 - INFO - [MainThread] [<module>] - API Timeouts (Connect/Read): 10s / 60s
2025-05-01 09:35:27,944 - INFO - [MainThread] [<module>] - API Retries: 3 attempts, 2s delay
2025-05-01 09:35:27,944 - INFO - [MainThread] [<module>] - Max Upload Workers: 3
2025-05-01 09:35:27,944 - INFO - [MainThread] [<module>] - Max Download Workers: 12
2025-05-01 09:35:27,945 - INFO - [MainThread] [<module>] - ============================================================
2025-05-01 09:35:27,945 - INFO - [MainThread] [<module>] - Configuration loaded successfully.
2025-05-01 09:35:27,946 - INFO - [MainThread] [<module>] - Custom Jinja filter 'format_bytes' registered.
2025-05-01 09:35:27,946 - INFO - [MainThread] [<module>] - Flask-CORS initialized. Allowing origins: http://localhost:4200
2025-05-01 09:35:27,947 - INFO - [MainThread] [<module>] - Flask application initialized.
2025-05-01 09:35:27,947 - INFO - [MainThread] [<module>] - Global state variables initialized (upload_progress_data, download_prep_data).
2025-05-01 09:35:27,949 - INFO - [MainThread] [<module>] - Custom Jinja filter 'format_bytes' registered.
2025-05-01 09:35:27,949 - INFO - [MainThread] [<module>] - Flask-CORS initialized. Allowing origins: http://localhost:4200
2025-05-01 09:35:27,950 - INFO - [MainThread] [<module>] - Flask application initialized.
2025-05-01 09:35:27,950 - INFO - [MainThread] [<module>] - Global state variables initialized (upload_progress_data, download_prep_data).
2025-05-01 09:35:28,103 - INFO - [MainThread] [<module>] - Database module initialized.
2025-05-01 09:35:28,540 - INFO - [MainThread] [<module>] - Initialized requests.Session for Telegram API calls.
2025-05-01 09:35:28,541 - INFO - [MainThread] [<module>] - Telegram API functions defined with Session and Retries.
2025-05-01 09:35:28,545 - INFO - [MainThread] [<module>] - Flask routes defined using configurable workers and linter fixes.
2025-05-01 09:35:28,545 - INFO - [MainThread] [<module>] - Starting Flask development server...
2025-05-01 09:35:28,567 - WARNING - [MainThread] [_log] -  * Debugger is active!
2025-05-01 09:35:28,573 - INFO - [MainThread] [_log] -  * Debugger PIN: 107-410-311
2025-05-01 09:35:33,081 - INFO - [Thread-3 (process_request_thread)] [index] - Serving index page.
2025-05-01 09:35:33,116 - INFO - [Thread-3 (process_request_thread)] [_log] - 127.0.0.1 - - [01/May/2025 09:35:33] "GET / HTTP/1.1" 200 -
2025-05-01 09:35:33,172 - INFO - [Thread-2 (process_request_thread)] [_log] - 127.0.0.1 - - [01/May/2025 09:35:33] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-05-01 09:35:37,525 - INFO - [Thread-4 (process_request_thread)] [initiate_upload] - Request initiate upload.
2025-05-01 09:35:37,526 - INFO - [Thread-4 (process_request_thread)] [initiate_upload] - [8735968e-04ef-41a5-a2fe-5416e592646c] Temp storage: uploads_temp\8735968e-04ef-41a5-a2fe-5416e592646c_.gitattributes
2025-05-01 09:35:37,527 - INFO - [Thread-4 (process_request_thread)] [initiate_upload] - [8735968e-04ef-41a5-a2fe-5416e592646c] Temp saved: '.gitattributes'.
2025-05-01 09:35:37,529 - INFO - [Thread-4 (process_request_thread)] [_log] - 127.0.0.1 - - [01/May/2025 09:35:37] "POST /initiate-upload HTTP/1.1" 200 -
2025-05-01 09:35:37,534 - INFO - [Thread-5 (process_request_thread)] [stream_progress] - SSE connect request for upload_id: 8735968e-04ef-41a5-a2fe-5416e592646c
2025-05-01 09:35:37,535 - INFO - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] Starting processing generator...
2025-05-01 09:35:37,535 - INFO - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] Processing: User='Brayer', File='.gitattributes'
2025-05-01 09:35:37,536 - INFO - [Thread-5 (process_request_thread)] [_log] - 127.0.0.1 - - [01/May/2025 09:35:37] "GET /stream-progress/8735968e-04ef-41a5-a2fe-5416e592646c HTTP/1.1" 200 -
2025-05-01 09:35:37,536 - INFO - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] Access ID: 4cc0ef259a
2025-05-01 09:35:37,540 - INFO - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] Single file workflow.
2025-05-01 09:35:37,544 - INFO - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] Compressed size: 188
2025-05-01 09:35:37,547 - INFO - [Thread-5 (process_request_thread)] [_send_single_file_task] - [8735968e-04ef-41a5-a2fe-5416e592646c] T> Sending '.gitattributes.zip' (188b) to -4603853425
2025-05-01 09:35:37,548 - INFO - [Thread-5 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File '.gitattributes.zip'] Attempting send.
2025-05-01 09:35:38,551 - INFO - [Thread-5 (process_request_thread)] [send_file_to_telegram] - [ChatID -4603853425, File '.gitattributes.zip'] API success (Attempt 1).
2025-05-01 09:35:38,552 - INFO - [Thread-5 (process_request_thread)] [_send_single_file_task] - [8735968e-04ef-41a5-a2fe-5416e592646c] T> Sent '.gitattributes.zip' to -4603853425. Success: True
2025-05-01 09:35:38,552 - INFO - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] Single sends done in 1.01s.
2025-05-01 09:35:38,552 - INFO - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] Success: 1/1
2025-05-01 09:35:38,553 - INFO - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] Attempting to save metadata to DB...
2025-05-01 09:35:38,554 - INFO - [Thread-5 (process_request_thread)] [_connect_to_db] - Attempting to connect to MongoDB Atlas host: telegrambot.sfoz7jc.mongodb.net...
2025-05-01 09:35:38,814 - ERROR - [Thread-5 (process_request_thread)] [_connect_to_db] - An unexpected error occurred during MongoDB connection: The DNS query name does not exist: _mongodb._tcp.telegrambot.sfoz7jc.mongodb.net.
Traceback (most recent call last):
  File "E:\Telegram_tool\Telegram_Bot_Tool\database.py", line 69, in _connect_to_db
    client = MongoClient(CONNECTION_STRING, server_api=ServerApi('1'))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 884, in __init__
    self._get_topology()  # type: ignore[unused-coroutine]
    ^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 1737, in _get_topology
    self._resolve_srv()
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\mongo_client.py", line 903, in _resolve_srv
    res = uri_parser._parse_srv(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\uri_parser.py", line 163, in _parse_srv
    nodes = dns_resolver.get_hosts()
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\srv_resolver.py", line 157, in get_hosts
    _, nodes = self._get_srv_response_and_hosts(True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\srv_resolver.py", line 131, in _get_srv_response_and_hosts
    results = self._resolve_uri(encapsulate_errors)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Telegram_tool\Telegram_Bot_Tool\.venv\Lib\site-packages\pymongo\synchronous\srv_resolver.py", line 125, in _resolve_uri
    raise ConfigurationError(str(exc)) from None
pymongo.errors.ConfigurationError: The DNS query name does not exist: _mongodb._tcp.telegrambot.sfoz7jc.mongodb.net.
2025-05-01 09:35:38,820 - ERROR - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] CRITICAL: Metadata save to DB failed: Failed to get collection: An unexpected error occurred during MongoDB connection: The DNS query name does not exist: _mongodb._tcp.telegrambot.sfoz7jc.mongodb.net.
2025-05-01 09:35:38,821 - INFO - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] Upload generator cleanup.
2025-05-01 09:35:38,822 - INFO - [Thread-5 (process_request_thread)] [_safe_remove_file] - [8735968e-04ef-41a5-a2fe-5416e592646c] Cleaned up original temp: uploads_temp\8735968e-04ef-41a5-a2fe-5416e592646c_.gitattributes
2025-05-01 09:35:38,824 - INFO - [Thread-5 (process_request_thread)] [process_upload_and_generate_updates] - [8735968e-04ef-41a5-a2fe-5416e592646c] Upload generator finished. Status: processing
